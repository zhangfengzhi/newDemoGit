<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>题本</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui_css_new/aui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/list_frame.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/jyeoo/ques_data.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
			body {
				margin: 0;
				background: rgba(0,0,0,0);
				font-size:18px;
			}
			.zuoye-name {
				line-height: 60px;
				width: 100%;
			}
			.answer-title {
				border-top: 1px solid #f1f1f1;
				height: 60px;
				width: 100%;
				margin-bottom: 20px;
			}
			.title {
				width: 50%;
				float: left;
			}
			.answer-title div {
				height: 40px;
				display: inline-block;
				line-height: 40px;
				margin-top: 13px;
				padding: 0 18px;
				color: #ffffff;
			}
			.seleted {
				width: 120px;
				color:#ffffff;
				float: right;
				height:36px;
				line-height:36px;
				text-align:center;
				margin-top:13px;
				font-size:16px;
			}
			.stem {
				padding: 20px 5%;
				max-width:100%;
				word-break:break-all;
				color:#98979D;
			}
			.stem img {
				max-width: 90%; height:auto;
			}
			.stem div,.stem p,.stem span{word-wrap: break-word;word-break: normal;font-size:18px; }
			.option dl {
				position:relative;
				border-radius: 5px;
				min-height: 55px;
				border: 2px solid #EFF1F1;
				margin-bottom: 20px;
			}
			.option dl dt {
				position:absolute;
				top:0px;
				bottom:-1px;
				display:block;
				font-size: 22px;
				font-weight: 600;
				width: 12%;
				height:100%;
				float: left;
				background: #EFF1F1;
				border-radius: 1px 0 0 1px;
				text-align: center;
			}
			.option dl dt div{
				position:absolute;
				top:50%;
				left:50%;
				margin-top:-17px;
				margin-left:-8px;
				height:30px;
			}
			.option dl dd {
				width: 84%;
				float: right;
				margin-right:1%;
				min-height: 55px;
				line-height: 25px;
				padding:15px 0;
				color:#98979D;
				word-wrap: break-word;
				word-break: normal; 
			}
			.option dl dd div p img{
				vertical-align: middle;
				margin:10px 0;
			}
			.option dl dd img {
				max-width: 85%;
			}
			.plrb15{padding:0 15px 15px 15px;}
			.no-question-data{text-align:center;color:#666;height:50px;line-height:50px;}
			.source-img{color:#9C9C9C;}
			.analysis-btn{width:92%;line-height:45px;text-align:center;color:#ffffff;margin-top:9px;border-radius:2px;margin-left:4%;margin-bottom:15px;}
		</style>
	</head>
	<body id="body" class="common-ipad-tibenIpad-tea">
		<div id="q_title"></div>
		<div class="q_div" id="q_div"></div>
		<script type="text/html" id="q_script">
			<div class="zuoye-name plr15 clearfix">
				<div class="title"><%=qt_name %></div>
				<div class="seleted" onclick="openStuListFrame('<%=question_id_char%>','<%=que_source%>');">查看错误详情</div>
			</div>
			<%if(html_json){%>
				<%if(que_source == 1){ %>
					<!--东师理想试题展示-->
					<div class="stem clearfix">
						<%=#commonRemoveQuestionEdit(html_json.question_title)%>
					</div>
					<!--客观题-->
					<%if(qt_type == 1){ %>
						<%if(qt_id == 72){ %>
							<div id="j_option" class="option plr15 clearfix">
								<dl class="clearfix">
									<dt><div>1</div></dt>
									<dd>正确
									</dd>
								</dl>
								<dl class="clearfix">
									<dt><div>2</div></dt>
									<dd>错误
									</dd>
								</dl>
							</div>
						<!--//判断题-->
						<%}else if(qt_id == 2){ %>
							<!--客观题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.question_answer_length; i++){%>
									<dl class="clearfix" >
										<dt><div><%=html_json.question_answer_first[i]%></div></dt>
										<dd><%=#html_json.quetionOption[i]%>
										</dd>
									</dl>
								<%}%>
							</div>
						<% } else if (qt_id == 26 || qt_id == 8) { %>
							<!--客观题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.question_answer_length; i++){%>
									<dl class="clearfix" >
										<dt><div><%=html_json.question_answer_first[i]%></div></dt>
										<dd><%=#html_json.quetionOption[i]%>
										</dd>
									</dl>
								<%}%>
							</div>
						<%}%>
					<% } %>
					<div id="j_right_answer_title" class="answer-title clearfix">
						<div>
							正确答案
						</div>
					</div>
					<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix">
						<%=#html_json.question_answer%>
					</div>
				<%}else{%>
					<!--菁优网试题展示-->
					<div class="stem clearfix">
						<%=#commonRemoveQuestionEdit(html_json.Content)%>
					</div>
					<%if(qt_type == 1){ %>
						<!--客观题-->
						<%if(qt_id == 1 || qt_id == 8 && html_json.Answers.length == 1) { %>
							<!--单选-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.Options.length; i++){%>
									<dl class="clearfix" >
										<dt><div><%=html_json.Options_first[i]%></div></dt>
										<dd><%=#html_json.Options[i]%>
										</dd>
									</dl>
								<%}%>
							</div>
							<!--//单选-->
						<%}else if(qt_id == 3 || qt_id == 8 && html_json.Answers.length > 1){%>
							<!--选择题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.Options.length; i++){%>
									<dl class="clearfix" >
										<dt><div><%=html_json.Options_first[i]%></div></dt>
										<dd><%=#html_json.Options[i]%>
										</dd>
									</dl>
								<%}%>
							</div> 
							<!--//选择题-->
						<%}else if(qt_id == 4){%>
							<!--判断题-->
							<div id="j_option" class="option plr15 clearfix">
								<dl class="clearfix" >
									<dt><div>1</div></dt>
									<dd>正确
									</dd>
								</dl>
								<dl class="clearfix" >
									<dt><div>2</div></dt>
									<dd>错误
									</dd>
								</dl>
							</div>
							<!--//判断题-->
						<%}%>
						<div class="j_jy answer-title clearfix">
	                        <div>
	                          	  正确答案
	                        </div>
	                    </div>
	                    <div class="j_jy source-img plrb15 right-answer img clearfix">
	                        <%if(qt_id == 4){%>
	                            <%if(html_json.Answers[0] == "√"){%>
	                              	  正确
	                            <%}else{%>
	                                	错误
	                            <%}%>
	                        <%}else{%>
	                            <%for(var i = 0; i < html_json.Answers.length; i++){%>
	                                <%=html_json.Options_first[html_json.Answers[i]]%>
	                            <%}%>
	                        <%}%>
	                    </div>
						<!--//客观题-->
					<%}%>
					<!--//菁优网试题展示-->
				<%}%>
				<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis('<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
				<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
					<div>
						题目解析
					</div>
				</div>
				<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>	
			<%}else{%>
				<div class="no-question-data">该题目信息正在生成，请稍候查看</div>
			<%}%>
		</script>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/template.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
	<script type="text/javascript">
		apiready = function() {
			commonSetTheme({"level":5,"type":0});
			var que_json = JSON.parse(Base64.decode(api.pageParam.q_base64));
			que_json.commonRemoveQuestionEdit=commonRemoveQuestionEdit;
			commonAddOnceHtml('q_div','q_script',que_json);
			judgeTextIndent();//判断text-indent和padding-left
		};
		/*
		*author:zhaoj
		*function:判断每个p标签的text-indent属性和padding-left属性，解决这个属性过大导致整体页面变宽的问题
		*date：201604014
		*/
		function judgeTextIndent(){
			var pArray = $api.domAll($api.byId('body'), 'p');
			var widthValue = Math.floor(api.winWidth/2);
			for(var i = 0; i < pArray.length; i++){		
				var textIndentValue = $api.cssVal(pArray[i],'text-indent');
				textIndentValue = textIndentValue.substring(0,textIndentValue.length-2)*1;
				if(textIndentValue > widthValue || textIndentValue < -widthValue){
					$api.css(pArray[i],'text-indent:0em;');
				}
				var paddingLeftValue = $api.cssVal(pArray[i],'padding-left');
				paddingLeftValue = paddingLeftValue.substring(0,paddingLeftValue.length-2)*1;
				if(paddingLeftValue > widthValue || paddingLeftValue < -widthValue){
					$api.css(pArray[i],'padding-left:0;');
				}

			}
		}
		/*
		*author:zhaoj
		*function:查看解析
		*date：20160414
		*/
		function viewAnalysis(question_id_char,que_source,jy_subject_en_name){
			showSelfProgress('获取解析中...');
			api.ajax({
				url : $api.getStorage('BASE_URL_ACTION') + '/xx/getQueHtmlInfo?random_num='+creatRandomNum()+'&question_id_char='+question_id_char+'&que_source='+que_source+'&person_id='+$api.getStorage("person_id")+'&identity_id='+$api.getStorage("identity")+'&jy_subject_en_name='+jy_subject_en_name,
				method : 'get',
				timeout : 30,
				dataType : 'json'
			}, function(ret, err) {
				api.hideProgress();
				if(err) {
					popToast('获取解析失败，请稍候再试');
				} else {
					if(ret.success) {
						var jx_info;
						if(que_source == 2){
							if(ret.html_json.Method){
								jx_info = ret.html_json.Method;
							}else{
								jx_info = "略";
							}
						}else{
							jx_info = Base64.decode(ret.html_json.question_analysis);
						}	
						$api.css($api.byId('j_jx_btn'),'display:none');
						$api.html($api.byId('j_analysis'),jx_info);
						$api.css($api.byId('j_analysis'),'display:block');
						$api.css($api.byId('j_analysis_title'),'display:block');
					} else {
						popToast('获取解析失败，请稍候再试');
					}
				}
			});
		}
		/*
		*author:zhaoj
		*function:查看错误详情
		*date：20171012
		*/	
		function openStuListFrame(question_id_char,que_source){
			commonExecScript('tibenIpad_detail_window','','reBackType("stu_list");',0);
			var header_h = api.pageParam.header_h;//顶部高度
			pageParamJson={"header_h":header_h,"question_id_char":question_id_char,"que_source":que_source};//打开frame页面json数据
			//打开frame页面
			commonOpenFrame("tibenIpad_stu_list_frame","tibenIpad_stu_list_frame.html",0,false,false,"rgba(0,0,0,0)",pageParamJson);
		}					
	</script>
</html>