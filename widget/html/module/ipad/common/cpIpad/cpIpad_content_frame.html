<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- html5：在创建html时为了防止页面缩放等不兼容效果，要创建个viewport  -->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<!-- 在IOS设备上，有时会将数字转为手机号，这里也要禁止下 -->
		<meta name="format-detection" content="telephone=no"/>
		<title>食谱页面</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/six_content.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/ipad/left-right-layout.css"/>
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
			.right-layout-body .person-info{padding:20px 145px 10px 92px;}
    		.right-layout-body .person-info .header-img{width:58px;height:58px;border-radius: 5px;}
	    	@media screen and (max-width: 464px) {
	    		.right-layout-body .person-info{padding:20px 75px 10px 100px;}
	    	}
	    </style>
	</head>
	<body class="right-layout-body common-ipad-cpIpadstu">
		<!--<div class="triangle-left">&nbsp;</div>-->
		<div class="top">
			<div class="name">详情</div>
			<div class="close" onclick="closeFrame();">关闭</div>
		</div>
		<div class="person-info">
			<img id="j_header_img" class="header-img" onerror="this.src='../../../../../image/common/header.png'" src="../../../../../image/fun-module/ipad/xwzx-person.png" />
			<div id="j_person_name" class="person-name ellipsis"></div>
			<div id="j_time" class="time"></div>
		</div>
		<div id="notice_title_div" class="detail-title word-wrap"></div>
		<div id="notice_con_div" class="detail-content word-wrap"></div>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/six_common.js" ></script>
	<script type="text/javascript" src="../../../../../script/assembly/photoBrowser.js"></script>
	<script type="text/javascript">
		var image_array=[];//所有图片路径
		apiready = function() {
			commonSetTheme({"level":5,"type":0});
			var data = JSON.parse(api.pageParam.transfer_data);
			var notice_title = Base64.decode(data.title_base64);
            var notice_person_name = Base64.decode(data.person_name_base64);
            var notice_create_time = Base64.decode(data.create_time_base64).substring(0,16);
            var notice = Base64.decode(data.content_base64);
//          var notice_sec_title = '<span class="aui-img-body ellipsis">' + notice_person_name+'</span><span class="create-time">'+ notice_create_time + '</span>';
			notice = transferBrStr(notice);
			var onerror_html = "this.src='../../../../../image/common/tpsx.png'";
			if (BASE_APP_TYPE == 1) {
				var notice_str1 = '<img';
				var notice_str2 = '<img onclick="openPicture(this);" onerror='+onerror_html;
				notice = notice.replaceAll(notice_str1, notice_str2);
			} else {
				var notice_str3 = '<img';
				var notice_str4 = '<img onclick="openPicture(this);"  onerror='+onerror_html;
				notice = notice.replaceAll(notice_str3, notice_str4);
			}
			$api.html($api.byId('j_person_name'), notice_person_name);
			$api.html($api.byId('j_time'), notice_create_time);
            $api.html($api.byId('notice_title_div'), notice_title);
//          $api.html($api.byId('notice_sec_title'), notice_sec_title);
            $api.html($api.byId('notice_con_div'), notice);
            notice.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi, function (match, capture) {
			  image_array.push(capture);
			});
		};
		/*
		*
		* function:关闭页面
		* author:zfz
		* date：20170919
		*/
		function closeFrame(){
			commonExecScript('cpIpad_index_window','','back();',0);
		}
		
		/*
		*author:zhaoj
		*function:打开图片预览
		*date：20171026
		*/
		function openPicture(e){
			//图片
			var res_url=$api.attr(e, 'src');
			//打开图片
			var index = 0;
			for(var i = 0; i <image_array.length;i++){
				if(image_array[i] == res_url){
					index = i;
				}
			}
			photoBrowser.open(image_array, index);
		}
	</script>
</html>