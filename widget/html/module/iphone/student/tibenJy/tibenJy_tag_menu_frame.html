<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>题本错题标签下拉菜单</title>
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
    	html, body {
        	background-color: rgba(0,0,0,0) !important;
   		 }
    	body{padding:0;margin:0;}
    	.shadow{position:absolute;left:0;top:0;width:100%;height:100%;z-index: 1;}
    	.header{width:100%;height:45px;}
    	.main{width:100%;}
    	.menu-list{
    		list-style:none;
    		background-color: #ffffff;
			box-shadow: 0px 0px 5px #cccccc;
			position: relative;
			width: 150px;
			float: right;
			z-index: 2;
			padding: 0;
			margin:0;
		}
		.menu-list li {
			height: 48px;
			line-height:48px;
			display: block;
			border-bottom: 1px solid #eeeeee;
			color: #333;
			font-family: sans-serif;
			text-align:center;
		}
		.menu-list li .icon-box{width:50px;height:48px;display:inline-block; text-align:center;}
		.menu-list li span{display:block;width:100%;height:48px;line-height:48px;float:left;text-align:center;}
		.ellipsis{white-space: nowrap;overflow: hidden;text-overflow: ellipsis;}
    </style>
	</head>
	<body class="common-iphone-tibenJy">
		<div class="shadow" tapmode onclick="api.closeFrame({name:'tibenJy_tag_menu_frame'});"></div>
		<div id="header" class="header"></div>
		<div id="wzmenu_div">
		</div>
		<script type="text/html" id="wzmenu_script">
			<div id="main" class="main">
				<ul class="menu-list">
					<%if(dic_type == -1){%>
							<li class="active"
						<%}else{%>
							<li 
						<%}%>
						onclick="changeTagType(-1,'全部',this);"><span class="ellipsis">全部</span></li>
					<%for(var i=0; i<list.length; i++) {%>
						<%if(dic_type == list[i].id){%>
							<li class="active"
						<%}else{%>
							<li 
						<%}%>
							onclick="changeTagType(<%=list[i].id %>,'<%=list[i].type_name%>',this);">
							<span class="ellipsis"><%=list[i].type_name%></span>
						</li>
					<% } %>
				</ul>
			</div>
		</script>
		
	</body>
	<script type="text/javascript" src="../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/template.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
	<script type="text/javascript">
		apiready = function() {commonSetTheme({"level":5,"type":0});
			var header_h = api.pageParam.header_h;
			$api.css($api.byId('header'), 'height:' + header_h + 'px;');
			$api.css($api.byId('main'), 'height:' + (api.winHeight - header_h) + 'px;');
			getQuestionDicType();
		};
		/*
		*author:zhaoj
		*function:获取错题标签
		*date：20161209
		*/
		function getQuestionDicType(){
			api.ajax({
				url : $api.getStorage('BASE_URL_ACTION') + '/ypt/xx/getQuestionDicType',
				method : 'get',
				dataType : 'json',
				timeout : 30,
				headers : {
'Cookie' : 'person_id=' + $api.getStorage("person_id") + '; identity_id=' + $api.getStorage("identity") + '; token=' + $api.getStorage("token_ypt") + ';'
}
			}, function(ret, err) {
				api.hideProgress();
				if (err) {
                    popToast('获取错题标签失败');
				} else {
					if (ret.success) {
						ret.dic_type = api.pageParam.dic_type;
						commonAddOnceHtml('wzmenu_div','wzmenu_script',ret);
					} else {
						popToast('获取错题标签失败');
					}
				}
			});
		}
		/*
		*author:zhaoj
		*function:错题标签切换
		*date：20161209
		*/
		function changeTagType(id,name,self){
			if(api.pageParam.type){
				//收藏的题
                commonExecScript('tibenJy_index_window','tibenJy_right_frame','changeTagType('+id+');',1);
			}else{
				 $api.removeCls($api.dom($api.byId('wzmenu_div'), '.active'), 'active');
				 $api.addCls(self, 'active');
				//做错的题
commonExecScript('tibenJy_index_window','tibenJy_wrong_frame','changeTagType("'+name+'",'+id+');',1);
			}
			commonCloseFrame('tibenJy_tag_menu_frame');
		}
	</script>
</html>