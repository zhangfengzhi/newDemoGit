<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>检测</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/testQuestionShow.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/list_frame.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../css/module/common/jyeoo/ques_data.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
			body {
				margin: 0;
				background: rgba(0,0,0,0);
				color:#98979D;
			}
			.clearfix:after {
				content: ' ';
				display: block;
				clear: both;
				visibility: hidden;
				line-height: 0;
				height: 0;
			}
			.zuoye-name {
				line-height: 55px;
				width: 100%;
			}
			.answer-title {
				border-top: 1px solid #f1f1f1;
				height: 55px;
				width: 100%;
				margin-bottom: 20px;
			}
			.title {
				width: 50%;
				float: left;
			}
			.answer-title div {
				height: 35px;
				display: inline-block;
				line-height: 35px;
				margin-top: 13px;
				padding: 0 15px;
				color: #ffffff;
			}
			.seleted {
				width: 20%;
				float: right;
				text-align: right;
			}
			.seleted .num {
				font-size: 22px;
			}
			.stem {
				padding: 20px 5%;
				max-width:100%;
				word-break:break-all;
			}
			.stem img {
				max-width: 90%;
				height:auto;
			}
			.stem div,.stem p,.stem span{word-wrap: break-word;word-break: normal; }
			.option dl {
				position:relative;
				border-radius: 5px;
				min-height: 55px;
				border: 2px solid #EFF1F1;
				margin-bottom: 20px;
			}
			.option dl dt {
				position:absolute;
				top:0px;
				bottom:-1px;
				display:block;
				font-size: 22px;
				font-weight: 600;
				width: 12%;
				height:100%;
				float: left;
				background: #EFF1F1;
		/*		line-height: 53px;*/
				border-radius: 1px 0 0 1px;
				text-align: center;
				color: #666;
			}
			.option dl dt div{
				position:absolute;
				top:50%;
				left:50%;
				margin-top:-10px;
				margin-left:-8px;
				height:20px
			}
			.option dl dd {
				width: 75%;
				float: right;
				margin-right:30px;
				min-height: 55px;
				line-height: 25px;
				padding:15px 0;
				color:#98979D;
				word-wrap: break-word;
				word-break: normal; 
			}
			.option dl dd div p img{
				vertical-align: middle;
				margin:10px 0;
			}
			.option dl dd img {
				max-width: 85%;
			}
			.option dl dd .judge{position:absolute;right:4%;top:50%;margin-top:-9px;width:18px;height:15px;display:inline-block;border:none !important;}
			.option dl dd .right{background:url(../../../../../image/fun-module/iphone/zuoye/right.png) left top no-repeat;background-size:18px;}
			.option dl dd .wrong{background:url(../../../../../image/fun-module/iphone/zuoye/wrong.png) left top no-repeat;background-size:18px;}
			.option .active dt {
				color: #ffffff !important;
			}
			.option .wrong{border:2px solid #ff0000 !important;}
    		.option .wrong dt{background:#ff0000  !important;color:#ffffff !important;}
			.upload-answer button {
				width: 100%;
				height: 55px;
				color: #ffffff;
				border-radius: 5px;
				font-size: 16px;
				margin-bottom: 20px;
			}
			.upload-answer button.no-use {
				background: #f1f1f1;
				color: #dCdCdc
			}
			.upload-answer button .aui-iconfont {
				margin-right: 5px;
				font-size: 22px;
			}
			.source-img ul {
				overflow: visible;
			}
			.source-img ul li {
				list-style: none;
				overflow: visible;
			}
			.source-img ul li div {
				text-align: center;
				border: 1px solid #f1f1f1;
				position: relative;
			}
			.next {
				line-height: 55px;
				text-align: right;
			}
			.source-img ul li.voice {
				position: relative;
				margin-bottom: 20px;
				background: url(../../image/yingyong/zuoye/voice.png) left top no-repeat;
				height: 50px;
				text-align: left;
				line-height: 45px;
				padding-left: 20px;
				color: #ffffff;
			}
			.source-img ul li.voice .delete-voice {
				position: absolute;
				right: -13px;
				top: -7px
			}
			.source-img ul li.voice .voice-right {
				position: absolute;
				right: -6px;
				top: 0;
				display:block;
				background: url(../../image/yingyong/zuoye/voice-right.png) right top no-repeat;
			}
			.img img{max-width: 100%;padding : 0 5% 15px 5%;max-width:90%;height:auto;}
			.plr15 {
				padding: 0 15px;
			}
			.no-data {
				text-align: center;
				color: #c0c0c0;
				background: url(../../../../../image/yingyong/zuoye/kong.png) center top no-repeat;
				padding-top: 55px;
				margin-bottom: 20px;
			}
			.footer-div{
				position:fixed;
				height:55px;
				background:#ffffff;
				display: block;
				bottom: 0px;
				width:100%;
				box-shadow:3px 0 4px #aaaaaa;
				z-index: 9999;
			}
			.footer-div .prevQ,.footer-div .nextQ{display: inline-block;width:50%;float: left;}
			.footer-div .prevQ{text-align: left;}
			.footer-div .nextQ{text-align: right;}
			.footer_div{height:70px;}
			.no-question-data{text-align:center;color:#666;height:50px;line-height:50px;}
			.plrb15{padding:0 15px 15px 15px;}
			.source-img{color:#9C9C9C;}
			.right-answer span{z-index: 0 !important;}
			.analysis-btn{width:92%;line-height:36px;text-align:center;color:#ffffff;margin-top:9px;border-radius:2px;margin-left:4%;margin-bottom:15px;}
		</style>
	</head>
	<body class="common-iphone-tibenJy" id="body">
		<div id="q_title"></div>
		<div class="q_div default-testQuestionShow" id="q_div">
		</div>
		<script type="text/html" id="q_script">
			<div class="zuoye-name plr15 clearfix">
				<div class="title"><%=qt_name %></div>
				<!--<div class="seleted"><font class="num"><%=sort%></font>/<%=list_length%></div>-->
			</div>
			<%if(html_json){%>
				<%if(que_source == 1){ %>
					<!--东师理想试题展示-->
					<div class="stem clearfix">
						<%=#commonRemoveQuestionEdit(html_json.question_title)%>
					</div>
					<!--客观题-->
					<%if(qt_type == 1){ %>
						<%if(qt_id == 72){ %>
							<div id="j_option" class="option plr15 clearfix">
								<dl class="clearfix" answerOption="正确">
									<dt><div>1</div></dt>
									<dd>正确
										<div id="j_right_1" class="judge right" style="display:none;"></div>
										<div id="j_wrong_1" class="judge wrong" style="display:none;"></div>
									</dd>
								</dl>
								<dl class="clearfix" answerOption="错误">
									<dt><div>2</div></dt>
									<dd>错误
										<div id="j_right_2" class="judge right" style="display:none;"></div>
										<div id="j_wrong_2" class="judge wrong" style="display:none;"></div>
									</dd>
								</dl>
							</div>
							<div id="j_right_answer_title" class="answer-title clearfix">
								<div>
									正确答案
								</div>
							</div>
							<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix">
								<%=#html_json.question_answer%>
							</div>
							<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
						<!--//判断题-->
						<%}else if(qt_id == 2){ %>
							<!--客观题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.question_answer_length; i++){%>
									<dl class="clearfix" answerOption="<%=html_json.question_answer_first[i]%>">
										<dt><div><%=html_json.question_answer_first[i]%></div></dt>
										<dd>
											<%=#html_json.quetionOption[i]%>
											<div id="j_right_<%=html_json.question_answer_first[i]%>" class="judge right" style="display:none;"></div>
											<div id="j_wrong_<%=html_json.question_answer_first[i]%>" class="judge wrong" style="display:none;"></div>
										</dd>
									</dl>
								<%}%>
							</div>
							<div id="j_right_answer_title" class="answer-title clearfix">
								<div>
									正确答案
								</div>
							</div>
							<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix">
								<%=#html_json.question_answer%>
							</div>
							<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
						<% } else if (qt_id == 26 || qt_id == 8) { %>
							<!--客观题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.question_answer_length; i++){%>
									<dl class="clearfix" answerOption="<%=html_json.question_answer_first[i]%>">
										<dt><div><%=html_json.question_answer_first[i]%></div></dt>
										<dd>
											<%=#html_json.quetionOption[i]%>
											<div id="j_right_<%=html_json.question_answer_first[i]%>" class="judge right" style="display:none;"></div>
											<div id="j_wrong_<%=html_json.question_answer_first[i]%>" class="judge wrong" style="display:none;"></div>
										</dd>
									</dl>
								<%}%>
							</div>                                      
							<div id="j_right_answer_title" class="answer-title clearfix">
								<div>
									正确答案
								</div>
							</div>
							<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix">
								<%=#html_json.question_answer%>
							</div>
							<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
						<%}%>
					<% } else { %>
						<!--主观题-->
						<div id="j_right_answer_title" class="answer-title clearfix">
							<div>
								正确答案
							</div>
						</div>
						<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix">
							<%=#html_json.question_answer%>
						</div>
						<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
					<% } %>
					<!--//东师理想试题展示-->
				<%}else{%>
					<!--菁优网试题展示-->
					<div class="stem clearfix">
						<%=#commonRemoveQuestionEdit(html_json.Content)%>
					</div>
					<%if(qt_type == 1){ %>
						<!--客观题-->
						<%if(qt_id == 1 || qt_id == 8 && html_json.Answers.length == 1) { %>
							<!--单选-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.Options.length; i++){%>
									<dl class="clearfix" answerOption="<%=i%>">
										<dt><div><%=html_json.Options_first[i]%></div></dt>
										<dd>
											<%=#html_json.Options[i]%>
											<div id="j_right_<%=html_json.Options_first[i]%>" class="judge right" style="display:none;"></div>
											<div id="j_wrong_<%=html_json.Options_first[i]%>" class="judge wrong" style="display:none;"></div>
										</dd>
									</dl>
								<%}%>
							</div>
							<!--//单选-->
						<%}else if(qt_id == 3 || qt_id == 8 && html_json.Answers.length > 1){%>
							<!--选择题-->
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < html_json.Options.length; i++){%>
									<dl class="clearfix" answerOption="<%=i%>">
										<dt><div><%=html_json.Options_first[i]%></div></dt>
										<dd>
											<%=#html_json.Options[i]%>
											<div id="j_right_<%=html_json.Options_first[i]%>" class="judge right" style="display:none;"></div>
											<div id="j_wrong_<%=html_json.Options_first[i]%>" class="judge wrong" style="display:none;"></div>
										</dd>
									</dl>
								<%}%>
							</div> 
							<!--//选择题-->
						<%}else if(qt_name.indexOf("判断")!=-1){%>
							<!--判断题-->
							<div id="j_option" class="option plr15 clearfix">
								<dl class="clearfix" answerOption="√">
									<dt><div>1</div></dt>
									<dd>正确
										<div id="j_right_1" class="judge right" style="display:none;"></div>
										<div id="j_wrong_1" class="judge wrong" style="display:none;"></div>
									</dd>
								</dl>
								<dl class="clearfix" answerOption="×">
									<dt><div>2</div></dt>
									<dd>错误
										<div id="j_right_2" class="judge right" style="display:none;"></div>
										<div id="j_wrong_2" class="judge wrong" style="display:none;"></div>
									</dd>
								</dl>
							</div>
							<!--//判断题-->
						<%}%>
						<div class="answer-title clearfix">
							<div>
								正确答案
							</div>
						</div>
						<div class="source-img plrb15 right-answer img clearfix">
							<%if(qt_name.indexOf("判断")!=-1){%>
								<%if(html_json.Answers[0] == "√"){%>
									正确
								<%}else{%>
									错误
								<%}%>
							<%}else{%>
								<%for(var i = 0; i < html_json.Answers.length; i++){%>
									<%=html_json.Options_first[html_json.Answers[i]]%>
								<%}%>
							<%}%>
						</div>
						<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
						<!--//客观题-->
					<%}else{%>
						<!--主观题-->
						<%if(jx_info == 0){%>
								<div id="j_jx_btn" class="analysis-btn" onclick="viewAnalysis(<%=sort%>,'<%=question_id_char%>','<%=que_source%>','<%=jy_subject_en_name%>')">查看解析</div>
								<div id="j_analysis_title" class="answer-title clearfix" style="display:none;">
									<div>
										题目解析
									</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix" style="display:none;"></div>
							<%}else{%>
								<div id="j_analysis_title" class="answer-title clearfix">
								<div>
									题目解析
								</div>
								</div>
								<div id="j_analysis" class="source-img plrb15 img clearfix">
									<%=#jx_info%>
								</div>
							<%}%>	
						<!--//主观题-->
					<%}%>
					<!--//菁优网试题展示-->
				<%}%>
			<%}else{%>
				<div class="no-question-data">该题目正在生成，请稍候查看</div>
			<%}%>
		</script>
		<div id="j_wk_title"  class="answer-title clearfix" style="display: none;">
			<div>
				微课讲解
			</div>
		</div>
		<div id="wklist_div" class="wklist_div"></div>
		<script type="text/html" id="wklist_script">
			<% if(wkdetail_list.length > 0){ %>
				<%for(var i=0; i<wkdetail_list.length; i++) {%>
					<!--微课列表-->
					<div class="section3" id="kcListDiv">
						<div class="item style1" tapmode="itemhover" onclick="openWeikeContent('<%=wkdetail_list[i].id %>','<%=wkdetail_list[i].wkds_name %>','<%=wkdetail_list[i].is_phone_wk %>','<%=wkdetail_list[i].phone_wk_file_id %>');">
							<div class="itemlogo userlogo"><img onerror="this.src='../../../../../image/yingyong/weike/wk_default.png'" src="../../../../../image/yingyong/weike/wk_default.png" alt="" data-echo="<%=wkdetail_list[i].wk_thumb_url %>">
							</div>
							<div class="itemshelf">
								<div class="shelfinfo01">
									<%=wkdetail_list[i].wkds_name %>
								</div>  
								<div class="shelfinfo04">
									教师：<%=wkdetail_list[i].teacher_name %>&nbsp;&nbsp;发布：<%=wkdetail_list[i].create_time.substring(0,10) %>
								</div>
								<div class="shelfinfo06">
									浏览次数：<%=wkdetail_list[i].play_count %>&nbsp;次
								</div>
							</div>
							
						</div>
					</div>
				<% } %>
			<% } %>
		</script>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/template.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
	<script type="text/javascript" src="../../../../../script/assembly/Merge.js"></script>
	<script type="text/javascript" src="../../../../../script/plug-in/echo.min.js"></script>
	<script type="text/javascript" src="../../../../../script/common/jszy_jy_common.js" ></script>
	<script type="text/javascript">
		var BASE_URL_ACTION;
		var BASE_APP_TYPE;
		var q_cur_num;//当前试题
		var q_json_str;//试题json
		var type;//判断是否要查看学生的答题情况
		apiready = function() {commonSetTheme({"level":5,"type":0});
			BASE_APP_TYPE = $api.getStorage('BASE_APP_TYPE');
			getZyInfoById();
		};
		function reWriteQuestion(q_cur) {
			var length = q_json_str.zy_info.list.length;
			if(length>0){
				var cur_list = q_json_str.zy_info.list[0];
				cur_list.commonRemoveQuestionEdit=commonRemoveQuestionEdit;
				commonAddOnceHtml('q_div','q_script',cur_list);
				judgeTextIndent();
				//加载微课
				isShowWk(cur_list.question_id,cur_list.question_id_char,cur_list.que_source,q_json_str.zy_info.zy_id);
			}else{
				$api.html($api.byId('q_div'), '<div class="no-question-data">暂无题目</div>');
			}
		}
		/*
		*author:zhaoj
		*function:判断每个p标签的text-indent属性，解决这个属性过大导致整体页面变宽的问题
		*date：201604014
		*/
		function judgeTextIndent(){
			var pArray = $api.domAll($api.byId('body'), 'p');
			var widthValue = Math.floor(api.winWidth/2);
			for(var i = 0; i < pArray.length; i++){		
				var textIndentValue = $api.cssVal(pArray[i],'text-indent');
				textIndentValue = textIndentValue.substring(0,textIndentValue.length-2)*1;
				if(textIndentValue > widthValue || textIndentValue < -widthValue){
					$api.css(pArray[i],'text-indent:0em;');
				}
				var paddingLeftValue = $api.cssVal(pArray[i],'padding-left');
				paddingLeftValue = paddingLeftValue.substring(0,paddingLeftValue.length-2)*1;
				if(paddingLeftValue > widthValue || paddingLeftValue < -widthValue){
					$api.css(pArray[i],'padding-left:0;');
				}

			}
		}
		/*
		*author:zhaoj
		*function:获取检测
		*date：20160405
		*/
		function getZyInfoById(){
			api.showProgress({
				title : '加载中...',
				modal : false
			});
			api.ajax({
				url :BASE_URL_ACTION + '/xx/getZyInfoById',
				method : 'post',
				timeout : 30,
				dataType : 'json',
				data : {
					values : {
						"random_num" : creatRandomNum(),
						"zy_id" : api.pageParam.zy_id,
						"zy_type" :1,
						"person_id":api.pageParam.person_id,
						"identity_id":api.pageParam.identity_id
					}
				},
				headers : {
		'Cookie' : 'person_id=' + $api.getStorage("person_id") + '; identity_id=' + $api.getStorage("identity") + '; token=' + $api.getStorage("token_ypt") + ';'
	}
			}, function(ret, err) {
				api.hideProgress();
				if (err) {
					q_json_str = {"zy_info" : {"list":[]}};
					reWriteQuestion(q_cur_num);
				} else {
					if(ret.success){
						q_json_str = {"zy_info" : {"list":[],"zy_desc":ret.zy_info.zy_desc,"zy_question_ids":ret.zy_info.zy_question_ids,"zy_type":ret.zy_info.zy_type,"zy_name":ret.zy_info.zy_name,"zy_id":ret.zy_info.zy_id}};
						var  list = ret.zy_info.ques;
						if(list.length>0){
							for(var i = 0; i<list.length;i++){
								if(list[i].question_id_char == api.pageParam.question_id_char){
									var oparam = new Object();
									oparam.list_length = list.length;
									oparam.question_id = list[i].question_id;
									oparam.que_scores = list[i].que_scores;
									oparam.que_source = list[i].que_source;
									oparam.jy_subject_en_name = list[i].jy_subject_en_name;
									oparam.qt_type = list[i].qt_type;
									oparam.qt_id = list[i].qt_id;
									oparam.sort = list[i].sort;
									oparam.qt_name = list[i].qt_name;
									oparam.question_id_char= list[i].question_id_char;
									oparam.jx_info = 0;
									//试题相关操作
									if(list[i].html_json){
										if(list[i].que_source == 1){
											//东师理想本地试题
												oparam.html_json={};
												var question_title = Base64.decode(list[i].html_json.question_title);
												var key = '/dsideal_yy';
												var key_re = BASE_URL_ACTION;
												oparam.html_json.question_title = question_title;
												if(oparam.html_json.question_title.indexOf(key_re) == -1){
												    oparam.html_json.question_title = question_title.replaceAll(key, key_re);
												}
												var question_analysis=Base64.decode(list[i].html_json.question_analysis);
												oparam.html_json.question_analysis = question_analysis;
												if(oparam.html_json.question_analysis.indexOf(key_re) == -1){
												    oparam.html_json.question_analysis = question_analysis.replaceAll(key, key_re);
												}
												oparam.html_json.question_analysis = oparam.html_json.question_analysis == ""?"略":oparam.html_json.question_analysis;
												oparam.html_json.question_answer= Base64.decode(list[i].html_json.question_answer);
												if(oparam.html_json.question_answer.indexOf() == -1){
												    oparam.html_json.question_answer= Base64.decode(list[i].html_json.question_answer).replaceAll(key, key_re);
												}
												if(list[i].html_json.quetionOption != ''){
													var count_length = count(list[i].html_json.quetionOption);
													oparam.html_json.question_answer_length = count_length;
													oparam.html_json.quetionOption=JSON.parse(commonQuetionOption(count_length,JSON.stringify(list[i].html_json.quetionOption),key,key_re));
													oparam.html_json.question_answer_first = JSON.parse(commonQuetionOptionFirst(count_length))
												}else{
													oparam.html_json.question_answer_length = 0;
												}
											}else{
												//菁优网试题
												oparam.html_json={};
												oparam.html_json.Method= list[i].html_json.Method;
												oparam.html_json.Answers= list[i].html_json.Answers;
												oparam.html_json.question_answer= list[i].html_json.Answers;
												oparam.html_json.Topics= list[i].html_json.Topics;
												oparam.html_json.Analyse= list[i].html_json.Analyse;
												oparam.html_json.Content= list[i].html_json.Content;
												oparam.html_json.Discuss= list[i].html_json.Discuss;
												oparam.html_json.Options= list[i].html_json.Options;
												oparam.html_json.Options_first = JSON.parse(commonQuetionOptionFirst(list[i].html_json.Options.length));
												oparam.html_json.Points= list[i].html_json.Points;
												oparam.html_json.Label= list[i].html_json.Label;
											}
										}else{
											oparam.html_json = list[i].html_json;
										}
									q_json_str.zy_info.list.push(oparam);
								}
							}
						}
						reWriteQuestion(q_cur_num);
					}else{
						q_json_str = {"zy_info" : {"list":[]}};
						reWriteQuestion(q_cur_num);
					}
				}
			});
		}
		/*
		*author:zhaoj
		*function:获取对象长度
		*date：20160406
		*/
		function count(o){
		    var t = typeof o;
			if(t == 'object'){
	            var n = 0;
	            for(var i in o){
	                    n++;
	            }
		    }
		    return n;
		};
		/*
		*author:zhaoj
		*function:查看微课
		*date：20160412
		*/
		function isShowWk(question_id,question_id_char,que_source,zy_id){
			api.ajax({
				url : BASE_URL_ACTION + '/xx/checkQuestionWeike',
				method : 'post',
				timeout : 30,
				dataType : 'json',
				returnAll : false,
				data : {
					values : {
						"random_num" : creatRandomNum(),
						"question_id_char":question_id_char,
						"que_source":que_source,
						"zy_id":zy_id
					}
				}
			}, function(ret, err) {
				if (err) {
					$api.css($api.byId('j_wk_title'),'display:none;');
					$api.css($api.byId('wklist_div'),'display:none;');
				} else {
					if(ret.success){
						loadData(question_id,question_id_char,zy_id);
						$api.css($api.byId('j_wk_title'),'display:block;');
						$api.css($api.byId('wklist_div'),'display:block;');
					}else{
						$api.css($api.byId('j_wk_title'),'display:none;');
						$api.css($api.byId('wklist_div'),'display:none;');
					}
				}
			});
		}
		/**
		 * 加载数据
		 * 周枫
		 * 2016.4.15
		 */
		function loadData(question_id,question_id_char,zy_id) {
			api.ajax({
				url : $api.getStorage('BASE_URL_ACTION') + '/xx/getQuestionWeike',
				method : 'post',
				dataType : 'json',
				timeout : 30,
				data : {
					values : {
						"question_id_char":question_id_char,
						"zy_id":zy_id
					}
				}
			}, function(ret, err) {
				if(err) {
                    popToast('获取微课列表失败');
				} else {
					if(ret.success) {
						var wk_list = ret.wkdetail_list;
						var wk_list_l = getJsonObjLength(wk_list);
						if (wk_list_l > 0) {
							for (var i = 0; i < wk_list_l; i++) {
								var wk_thumb_id = wk_list[i].thumb_id;
//								var wk_thumb_id = '8E75B87E-68AC-4ACA-87EE-988207BE549C';
								var wk_thumb_url = '';
								if (BASE_APP_TYPE == 1) {
									//https://dsideal.obs.cn-north-1.myhuaweicloud.com/down/Thumbs/8E/8E75B87E-68AC-4ACA-87EE-988207BE549C.thumb
									wk_thumb_url = url_path + BASE_THUMB_BEGIN + wk_thumb_id.substring(0, 2) + '\/' + wk_thumb_id + BASE_THUMB_END;
								} else {
									wk_thumb_url = BASE_URL_ACTION + BASE_THUMB_BEGIN + wk_thumb_id.substring(0, 2) + '\/' + wk_thumb_id + BASE_THUMB_END;
								}
								wk_list[i]["wk_thumb_url"] = wk_thumb_url;
							}
						}
						var html_type = template.render('wklist_script', ret);
						document.getElementById('wklist_div').innerHTML = html_type;
						
						//延迟加载图片
						setTimeout(function() {
							echoInit();
						}, 300);
						
					} else {
						api.toast({
		                    msg:'获取微课列表失败'
	                    });
					}
				}
				//通知顶部下拉刷新数据加载完毕，组件会恢复到默认状态
						commonControlRefresh();
			});
		}
		/**
		 * 打开内容页面
		 * 周枫
		 * 2015.12.17
		 */
		function openWeikeContent(wk_id, wk_name, is_phone_wk, phone_wk_file_id) {
			//先重置通知window返回哪个页面
			commonExecScript('tibenJy_chat_que_window','','reBackType("content");',0);
			var pageParamJson={
                'wk_id' : wk_id,
                'is_phone_wk' : is_phone_wk,
                'phone_wk_file_id' : phone_wk_file_id
            };//打开frame页面json数据
            commonOpenFrame("common_weike_frame","widget://html/common/common_weike_frame.html",header_h,false,false,"#ffffff",pageParamJson);//打开分组管理的frame页面
		}
				/*
		*author:zhaoj
		*function:查看解析
		*date：20160414
		*/
		function viewAnalysis(sort,question_id_char,que_source,jy_subject_en_name){
			showSelfProgress('获取解析中...');
			api.ajax({
				url : $api.getStorage('BASE_URL_ACTION') + '/xx/getQueHtmlInfo?random_num='+creatRandomNum()+'&question_id_char='+question_id_char+'&que_source='+que_source+'&person_id='+$api.getStorage("person_id")+'&identity_id='+$api.getStorage("identity")+'&jy_subject_en_name='+jy_subject_en_name,
				method : 'get',
				timeout : 30,
				dataType : 'json'
			}, function(ret, err) {
				api.hideProgress();
				if(err) {
					popToast('获取解析失败，请稍候再试');
				} else {
					if(ret.success) {
						if(que_source == 2){
							if(ret.html_json.Method){
								q_json_str.zy_info.list[0].jx_info = ret.html_json.Method;
							}else{
								q_json_str.zy_info.list[0].jx_info = "略";
							}
						}else{
							q_json_str.zy_info.list[0].jx_info = Base64.decode(ret.html_json.question_analysis);
						}	
						var key = '/dsideal_yy';
                        var key_re = BASE_URL_ACTION;
                        q_json_str.zy_info.list[0].jx_info = q_json_str.zy_info.list[0].jx_info.replaceAll(key, key_re);
                        q_json_str.zy_info.list[0].jx_info = q_json_str.zy_info.list[0].jx_info == ""?"略":q_json_str.zy_info.list[0].jx_info;
						$api.css($api.byId('j_jx_btn'),'display:none');
						$api.html($api.byId('j_analysis'),q_json_str.zy_info.list[0].jx_info);
						$api.css($api.byId('j_analysis'),'display:block');
						$api.css($api.byId('j_analysis_title'),'display:block');
					} else {
						popToast('获取解析失败，请稍候再试');
					}
				}
			});
		}
	</script>
</html>