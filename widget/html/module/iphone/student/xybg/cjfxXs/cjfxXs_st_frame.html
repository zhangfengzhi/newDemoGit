<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>试题分析</title>
		<link rel="stylesheet" type="text/css" href="../../../../../../css/aui/aui.css" />
		<link rel="stylesheet" type="text/css" href="../../../../../../css/module/common/jyeoo/ques_data.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
	    <style>
			body {
				margin: 0;
				color:#98979D;
			}
			.clearfix:after {
				content: ' ';
				display: block;
				clear: both;
				visibility: hidden;
				line-height: 0;
				height: 0;
			}
			.zuoye-name {
				border-bottom: 2px solid #e0e0e0;
				line-height: 55px;
				width: 100%;
			}
			.answer-title {
				border-top: 1px solid #f1f1f1;
				height: 55px;
				width: 100%;
				margin-bottom: 20px;
			}
			.title {
				width: 50%;
				display:inline-block;
				text-align:right;
				float:right;
			}
			.answer-title div {
				height: 35px;
				display: inline-block;				
				line-height: 35px;
				margin-top: 13px;
				padding: 0 15px;
				color: #ffffff;
			}
			.seleted {
				display:inline-block;
			}
			.seleted .num {
				font-size: 22px;				
			}
			.stem {
				padding: 20px 5%;
				max-width:100%;
				word-break:break-all;
			}
			.stem img {
				max-width: 90%;
				height:auto;
			}
			.stem div,.stem p,.stem span{word-wrap: break-word;word-break: normal; }
			.option dl {
				position:relative;
				border-radius: 5px;
				min-height: 55px;
				border: 2px solid #EFF1F1;
				margin-bottom: 20px;
			}
			.option dl dt {
				position:absolute;
				top:0px;
				bottom:-1px;
				display:block;
				font-size: 22px;
				font-weight: 600;
				width: 12%;
				height:100%;
				float: left;
				background: #EFF1F1;
		/*		line-height: 53px;*/
				border-radius: 1px 0 0 1px;
				text-align: center;
				color: #666;
			}
			.option dl dt div{
				position:absolute;
				top:50%;
				left:50%;
				margin-top:-10px;
				margin-left:-8px;
				height:20px
			}
			.option dl dd {
				width: 75%;
				float: right;
				margin-right:30px;
				min-height: 55px;
				line-height: 25px;
				padding:15px 0;
				color:#98979D;
				word-wrap: break-word;
				word-break: normal; 
			}
			.option dl dd div p img{
				vertical-align: middle;
				margin:10px 0;
			}
			.option dl dd img {
				max-width: 85%;
			}
			.option dl dd .judge{position:absolute;right:4%;top:50%;margin-top:-9px;max-width:15%;width:18px;}			
			.option .wrong{border:2px solid #ff0000 !important;}
    		.option .wrong dt{background:#ff0000  !important;color:#ffffff !important;}
			.upload-answer button {
				width: 100%;
				height: 55px;			
				color: #ffffff;
				border-radius: 5px;
				font-size: 16px;
				margin-bottom: 20px;
			}
			.upload-answer button.no-use {
				background: #f1f1f1;
				color: #dCdCdc
			}
			.upload-answer button .aui-iconfont {
				margin-right: 5px;
				font-size: 22px;
			}
			.source-img ul {
				overflow: visible;
			}
			.source-img ul li {
				list-style: none;
				overflow: visible;
			}
			.source-img ul li div {
				text-align: center;
				border: 1px solid #f1f1f1;
				position: relative;
			}
			.next {
				line-height: 55px;
				text-align: right;
			
			}
			.source-img ul li.voice {
				position: relative;
				margin-bottom: 20px;
				background: url(../../../../../../image/fun-module/iphone/zuoye/voice.png) left top no-repeat;
				height: 50px;
				text-align: left;
				line-height: 45px;
				padding-left: 20px;
				color: #ffffff;
			}
			.source-img ul li.voice .delete-voice {
				position: absolute;
				right: -13px;
				top: -7px
			}
			.source-img ul li.voice .voice-right {
				position: absolute;
				right: -6px;
				top: 0;
				display:block;
				background: url(../../../../../../image/fun-module/iphone/zuoye/voice-right.png) right top no-repeat;
			}
			.img img{max-width: 100%;margin : 0 5% 15px 5%;max-width:90%;height:auto;}
			.plr15 {
				padding: 0 15px;
			}
			.no-data {
				text-align: center;
				color: #c0c0c0;
				background: url(../../../../../../image/fun-module/iphone/zuoye/kong.png) center top no-repeat;
				padding-top: 55px;
				margin-bottom: 20px;
			}
			.footer-div{
				position:fixed;
				height:55px;
				background:#ffffff;
				display: block;
				bottom: 0px;
				width:100%;
				box-shadow:3px 0 4px #aaaaaa;
				z-index: 9999;
			}
			.footer-div .prevQ,.footer-div .nextQ{display: inline-block;width:50%;float: left;}
			.footer-div .prevQ{text-align: left;}
			.footer-div .nextQ{text-align: right;}
			.kb{height:15px;}
			.no-question-data{text-align:center;color:#666;height:50px;line-height:50px;}
			.plrb15{padding:0 15px 15px 15px;}
			.source-img{color:#9C9C9C;}
			.right-answer span{z-index: 0 !important;}
			.class-name{color:#333333;padding:15px 0;font-weight:bold;}
			.person-name{word-wrap: break-word;word-break: normal;}
			.mg0{margin-bottom:0;}
			table{width:100%;border-right:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0;}
			table th,table td{border-top:1px solid #e0e0e0;border-left:1px solid #e0e0e0;text-align:center;line-height:30px;}
			table td{padding:8px 0;}
		</style>
	</head>
	<body id="body" class="common-iphone-cjfxXs">
		<div id="q_title"></div>
		<div class="q_div" id="q_div">
		</div>
		<script type="text/html" id="q_script">
			<div class="zuoye-name plr15 clearfix">
				<div class="seleted">第<font class="num">&nbsp;<%=sort%>&nbsp;</font>题</div>
				<div class="title"><%=qt_name %></div>
			</div>
			<%if(question_title){%>
                <!--东师理想试题展示-->
                <div class="stem clearfix">
					<%=#question_title%>
				</div>
                <!--客观题-->
                <%if(qt_type == 1){ %>
					<!--//客观题-->
					<% if(qt_id == 2 || qt_id == 8 || qt_id == 26){ %>
						<!--客观题-->
						<div id="j_option" class="option plr15 clearfix">
							<%for(var i = 0; i < question_answer_length; i++){%>
								<dl class="clearfix" answerOption="<%=question_answer_first[i]%>">
									<dt><div><%=question_answer_first[i]%></div></dt>
									<dd>
										<%=#quetionOption[i]%>
									</dd>
								</dl>
							<%}%>
						</div>
					<% } else if (qt_id == 72) { %>
						<%if (!quetionOption && qt_name =="判断题") { %>
							<div id="j_option" class="option plr15 clearfix">
								<dl class="clearfix" answerOption="正确">
									<dt><div>1</div></dt>
									<dd>正确
										<img id="j_right_1" class="judge" style="display:none;" src="../../../../../../image/fun-module/iphone/zuoye/right.png" alt="对" />
										<img id="j_wrong_1" class="judge" style="display:none;" src="../../../../../../image/fun-module/iphone/zuoye/wrong.png" alt="对" />
									</dd>
								</dl>
								<dl class="clearfix" answerOption="错误">
									<dt><div>2</div></dt>
									<dd>错误
										<img id="j_right_2" class="judge" style="display:none;" src="../../../../../../image/fun-module/iphone/zuoye/right.png" alt="对" />
										<img id="j_wrong_2" class="judge" style="display:none;" src="../../../../../../image/fun-module/iphone/zuoye/wrong.png" alt="对" />
									</dd>
								</dl>
							</div>
						<%}else{%>
							<div id="j_option" class="option plr15 clearfix">
								<%for(var i = 0; i < question_answer_length; i++){%>
									<dl class="clearfix" answerOption="<%=question_answer_first[i]%>">
										<dt><div><%=question_answer_first[i]%></div></dt>
										<dd>
											<%=#quetionOption[i]%>
										</dd>
									</dl>
								<%}%>
							</div>
						<%}%>
					<% } %>
				<% } %>
				<div class="answer-title clearfix"><div>本题满分</div></div>
				<div class="source-img plrb15 right-answer img clearfix"><%=totalScore%>分</div>
				<div class="answer-title clearfix"><div>我的得分</div></div>
				<div class="source-img plrb15 right-answer img clearfix"><%=score%>分</div>
				<div class="answer-title clearfix"><div>我的答案</div></div>
				<%if(myAnswer){%>
					<div class="source-img plrb15 right-answer img clearfix"><%=#myAnswer%></div>
				<%}else{%>
					<div class="source-img plrb15 right-answer img clearfix">暂未上传答题卡</div>
				<%}%>
				<div id="j_right_answer_title" class="answer-title clearfix"><div>正确答案</div></div>
				<div id="j_right_answer" class="source-img plrb15 right-answer img clearfix"><%=#question_answer%></div>
				<div class="answer-title clearfix"><div>试题数据</div></div>
				<div class="source-img plrb15 right-answer img clearfix">
					<table cellspacing="0" cellpadding="0">
						<tbody>
		                    <tr>
		                        <th>分值</th>
		                        <th>最高分</th>
		                        <th>最低分</th>
		                        <th>平均分</th>
		                        <th>难度</th>
		                    </tr>
                            <tr >
                                <td><%=totalScore%></td>
                                <td><%=highestScore%></td>
                                <td><%=lowestScore%></td>
                                <%if(type == 0){%>
                                	<td><%=classAvg%></td>
                                	<td><%=classScoreRate%></td>
                                <%}else if(type == 1){%>
                                	<td><%=schoolAvg%></td>
                                	<td><%=schoolScoreRate%></td>
                                <%}else if(type == 2){%>
                                	<td><%=districtAvg%></td>
                                	<td><%=districtScoreRate%></td>
                                <%}else{%>
                                	<td><%=cityAvg%></td>
                                	<td><%=(cityScoreRate / 100).toFixed(2)%></td>
                                <%}%>
                            </tr>
               			</tbody>
					</table>
				</div>
				<div class="answer-title clearfix"><div>本题涉及考点</div></div>
				<%if(zsd){%>
					<div class="source-img plrb15 right-answer img clearfix"><%=#zsd%></div>
				<%}else{%>
					<div class="source-img plrb15 right-answer img clearfix">暂无考点</div>
				<%}%>
				<div class="answer-title clearfix"><div>考法</div></div>
				<%if(examination){%>
					<div class="source-img plrb15 right-answer img clearfix"><%=#examination%></div>
				<%}else{%>
					<div class="source-img plrb15 right-answer img clearfix">暂无考法</div>
				<%}%>
				<div class="answer-title clearfix"><div>试题解析</div></div>
				<div id="j_analysis" class="source-img plrb15 img clearfix"><%=#question_analysis%></div>
			<%}else{%>
                <div class="no-question-data">该试题正在生成，请稍候查看</div>
            <%}%>
		</script>
		<div class="kb"></div>
	</body>
	<script type="text/javascript" src="../../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../../script/plug-in/template.js" ></script>
	<script type="text/javascript" src="../../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../../script/common/common.js" ></script>
	<script type="text/javascript" src="../../../../../../script/assembly/Merge.js"></script>
	<script type="text/javascript" src="../../../../../../script/module/common/cjfxXs.js"></script>
	<script type="text/javascript">
		var header_h;
		var q_json_str;//检测整理之后的数据
		var qt_type = 2;
		var sort = 1;
		var qt_name = "填空题";
		var que_source = 1;
		var qt_id = 6;
       	var jy_subject_en_name = "ds";
       	var question_id_char = 	"3EE1486D-6F1E-7D78-785C-A3838272D291";
       	var transmit_param;
		apiready = function() {
			commonSetTheme({"level":6,"type":0});
			changePersonInfo();
			header_h = api.pageParam.header_h;
			transmit_param = JSON.parse(api.pageParam.transmit_param);
			qryDtqQues();
		};
		/*
		*author:zhaoj
		*function:将试题显示到页面中
		*date：201604014
		*/
		function reWriteQuestion() {
			var length = q_json_str.zy_info.list.length;
			if(length>0){
				answers_count=0;
				var html_type = template.render('q_script', q_json_str.zy_info.list[0]);
				document.getElementById('q_div').innerHTML = html_type;
				judgeTextIndent();
			}else{
				$api.html($api.byId('q_div'), '<div class="no-question-data">暂无试题解析</div>');
			}
		}
		/*
		*author:zhaoj
		*function:判断每个p标签的text-indent属性，解决这个属性过大导致整体页面变宽的问题
		*date：201604014
		*/
		function judgeTextIndent(){
			var pArray = $api.domAll($api.byId('body'), 'p');
			var widthValue = Math.floor(api.winWidth/2);
			for(var i = 0; i < pArray.length; i++){		
				var textIndentValue = $api.cssVal(pArray[i],'text-indent');
				textIndentValue = textIndentValue.substring(0,textIndentValue.length-2)*1;
				if(textIndentValue > widthValue || textIndentValue < -widthValue){
					$api.css(pArray[i],'text-indent:0em;');
				}
				var paddingLeftValue = $api.cssVal(pArray[i],'padding-left');
				paddingLeftValue = paddingLeftValue.substring(0,paddingLeftValue.length-2)*1;
				if(paddingLeftValue > widthValue || paddingLeftValue < -widthValue){
					$api.css(pArray[i],'padding-left:0;');
				}

			}
		}
		/*
		*author:zhaoj
		*function:获取试题数据
		*date：20170725
		*/
		function qryDtqQues(){
			showSelfProgress('加载中...');
			api.ajax({
				url :ip_url_data + '/question/qryDtqQues?question_id_char='+transmit_param.questionIdChar+'&random_num='+creatRandomNum(),
				method : 'get',
				timeout : 30,
				dataType : 'json',
				headers : {
				'Cookie' : 'person_id=' + student_id_mr + '; identity_id=' + identity_mr + '; token=' + token+ ';'
			}
			}, function(ret, err) {
				api.hideProgress();
				q_json_str = {"zy_info" : {"list":[]}};
				if (err) {
				} else {
					if(ret.success){
						var list = ret.list;
						if(list.length > 0){
							 var oparam = new Object();
		                    oparam.list_length = 1;
		                    oparam.sort = transmit_param.questionName;
		                    oparam.qt_id = list[0].question_type_id;
		                    oparam.qt_name = list[0].question_type_name;
		                    oparam.zsd = list[0].zsd;
		                    oparam.qt_type = transmit_param.qt_type;
		                    oparam.type = transmit_param.type;
		                    oparam.score = transmit_param.score;
		                    oparam.totalScore = transmit_param.totalScore;
		                    oparam.classAvg = transmit_param.classAvg;
		                    oparam.schoolAvg = transmit_param.schoolAvg;
		                    oparam.districtAvg = transmit_param.districtAvg;
		                    oparam.cityAvg = transmit_param.cityAvg;
		                    oparam.classScoreRate = transmit_param.classScoreRate;
		                    oparam.schoolScoreRate = transmit_param.schoolScoreRate;
		                    oparam.districtScoreRate = transmit_param.districtScoreRate;
		                    oparam.cityScoreRate = transmit_param.cityScoreRate;
		                    oparam.highestScore = transmit_param.highestScore;
		                    oparam.lowestScore = transmit_param.lowestScore;
		                    oparam.examination = transmit_param.examination;
	                   	 	oparam.myAnswer = transmit_param.myAnswer;
		                    if(list[0].question_title){
		                        oparam.ques_html={};
		                        var question_title = Base64.decode(list[0].question_title);
		                        var key = '/dsideal_yy';
		                        var key_re = ip_url_data;
		                        oparam.question_title = question_title.replaceAll(key, key_re);
		                        var question_analysis=Base64.decode(list[0].question_analysis);
		                        oparam.question_analysis = question_analysis.replaceAll(key, key_re);
		                        oparam.question_answer= Base64.decode(list[0].question_answer).replaceAll(key, key_re);
		                        if(list[0].quetionOption != ''){
		                            var count_length = getJsonObjLength(list[0].quetionOption);
		                            oparam.question_answer_length = count_length;
		                            oparam.quetionOption=JSON.parse(commonQuetionOption(count_length,JSON.stringify(list[0].quetionOption),key,key_re));
		                            oparam.question_answer_first = JSON.parse(commonQuetionOptionFirst(count_length))
		                        }else{
		                            oparam.question_answer_length = 0;
		                        }
		                    }
		                    q_json_str.zy_info.list.push(oparam);
		                }
					}else{
					}
				}
				reWriteQuestion();
			});
		}
	</script>
</html>