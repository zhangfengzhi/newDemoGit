<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>主题活动</title>
    <link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css"/>
    <link rel="stylesheet" type="text/css" href="../../../../../css/module/common/table-body.css"/>
    <link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
    <style>
    	body{color:#595757;padding:10px 0;font-size:14px;}
    	.content{position:relative;padding:10px 10px;width: 100%;}
    	.table-body th, .table-body td{font-size:14px;line-height:45px;}
    	.table-body td{padding:0;width: 50%}
    	.no-data{padding-top:0;}
    </style>
</head>
<body class="common-iphone-zthd-tea">
	<div class="content">
		<table  class="table-body">
			<tr>
                <th>序号</th>
                <th>姓名</th>
            </tr>
            <tbody id="list_body"></tbody>
            <script type="text/html" id="list_script">
            <%if(list.length == 0){%>
            <tr><td colspan="5"><div class="no-data">暂时没有数据</div></td></tr>
            <%}else{%>
            <%for(var i = 0; i < list.length; i++){%>
            <tr>
            	<td><%=list[i].index%></td>
            	<td><%=list[i].person_name%></td>
            </tr>
            <%}%>
            <%}%>
           </script>
		</table >
	</div>
</body>
<script type="text/javascript" src="../../../../../script/api.js"></script>
<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
<script type="text/javascript" src="../../../../../script/assembly/UIAlbumBrowser.js"></script>
<script type="text/javascript" src="../../../../../script/assembly/getPicture.js"></script>
<script type="text/javascript" src="../../../../../script/assembly/photoBrowser.js"></script>
<script type="text/javascript" src="../../../../../script/plug-in/template.js" ></script>
<script type="text/javascript">
	var oparam;
	var currentPage = 1;
	var totalPages = 1;
	var topic_id = "";
	apiready = function() {
		topic_id = api.pageParam.topic_id;
		commonSetTheme({"level":5,"type":0});
//		get_unplay_person_info();
		initData(1);
		commonScrollBottomReload();
		commonRefreshHeaderInfo(); 
	};
	function initData(current_page){
		currentPage = current_page;
		get_unplay_person_info();
	}
	/*
    *author:zhaoj
    *function:通过主题id获取此主题下的作品列表
    *interface:张海
    *date：20171023
    */
	function get_unplay_person_info(){
		api.ajax({
			url : BASE_URL_ACTION + '/ypt/space/topic/get_topic_notworks_stat_byid?random_num='+creatRandomNum()+'&topic_id='+topic_id+'&page_num='+currentPage+'&page_size=20',
			method : 'get',
			timeout : 0,
			dataType : 'json',
			headers : {
	'Cookie' : 'person_id=' + $api.getStorage("person_id") + '; identity_id=' + $api.getStorage("identity") + '; token=' + $api.getStorage("token_ypt") + ';'
	}
			}, function(ret, err) {
				if(err){
					popToast('获取人员信息失败，请稍候重试');
				}else{
					if(ret.success){
						for (var i=0;i < ret.list.length;i++)
						{
							ret.list[i].index = (currentPage-1)*20+i+1;
						}
						totalPages = ret.total_page;
						commonAddManyHtml('list_body','list_script',ret);
					}else{
						popToast('获取人员信息失败，请稍候重试');
					}
				}
			api.hideProgress();
			//通知顶部下拉刷新数据加载完毕，组件会恢复到默认状态
			commonControlRefresh();
		});
	}
	/*
	*author:wangdongy
	*function:关闭页面
	*date：2017.5.15
	*/
	function closeFrame(){
		commonExecScript('zthd_hd_window','','back();',3);
	}
</script>
</html>