<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- html5：在创建html时为了防止页面缩放等不兼容效果，要创建个viewport  -->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<!-- 在IOS设备上，有时会将数字转为手机号，这里也要禁止下 -->
		<meta name="format-detection" content="telephone=no"/>
		<title>新闻资讯数据页面</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
			.h1 {
				height: 1px;
				background: #f0f0f0;
			}
			.title {
				font-size: 20px;
				padding: 5px 15px 15px 15px;
				line-height: 30px;
				color: #484848;
				word-break: break-all;
				word-wrap: break-word;
			}
			.create-time {
				display: inline-block;
				float: right;
				color: #C7C7C7;
				font-size: 12px;
			}
			.aui-img-body {
				display: inline-block;
				max-width: 50%;
				color: #C7C7C7;
				font-size: 12px;
			}
			.ellipsis {
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}
			.content {
				color: #3A3A3A;
				padding: 10px 15px;
				word-break: break-all;
				word-wrap: break-word;
				font-size: 16px;
			}
			.content table, .content p, .content div {
				max-width: 100% !important;
				word-break: break-all;
				word-wrap: break-word;
				height: auto !important;
				color: #3A3A3A;
				font-size: 16px;
			}
			.ima_notice {
				padding: 12px 0;
			}
			li{list-style:inherit;overflow: visible;}
		    ol{padding-left:25px;}
		</style>
	</head>
	<body class="common-iphone-xwzx">
		<div class="aui-content">
			<div id="notice_title_div" class="title"></div>
			<div style="padding: 5px 15px; " id="notice_sec_title"></div>
			<div id="notice_con_div" class="content"></div>
		</div>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js" ></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/template.js" ></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js"></script>
	<script type="text/javascript" src="../../../../../script/assembly/photoBrowser.js"></script>
	<script type="text/javascript">
		var notice_id;
		var image_array=[];
		apiready = function() {
			commonSetTheme({"level":5,"type":0});
			notice_id = api.pageParam.notice_id;
			loadNoticeContentData();
		};
		/**
		 * 加载新闻资讯内容
		 * 周枫
		 * 2015.11.24
		 */
		function loadNoticeContentData() {
			commonShowProgress('加载中...',false);
			api.ajax({
				url : BASE_URL_ACTION + '/notice/getNoticeById?notice_id=' + notice_id,
				method : 'get',
				timeout : 30,
				dataType : 'json',
				cache : false
			}, function(ret, err) {
				api.hideProgress();
				if (ret.success) {
					var notice_con = ret.notice.content;
					var notice_str1 = '';
					var notice_str2 = '';
					var notice_str11 = '';
					var  onerror_img="this.src='../../../../../image/common/tpsx.png'";
					if (BASE_APP_TYPE == 1) {
						notice_str1 = 'src=\"down\/Material\/';
						notice_str11 = 'src=\"' + url_path_down + 'down\/Material\/';
						//解决云版图片不缩放问题
						notice_str5 = '<img';
						notice_str2 = '<img class="ima_notice" onerror='+onerror_img+' onclick="openImage(this)"';
						//解决网络图片不缩放问题
						notice_str6 = '<img src=';
						notice_str7 = '<img class="ima_notice" onerror='+onerror_img+' onclick="openImage(this)" src=';
					} else {
						notice_str1 = 'src=\"/dsideal_yy/';
						notice_str2 = 'src=\"' + BASE_URL_ACTION + '\/';
						notice_str6 = '<img src=';
						notice_str7 = '<img class="ima_notice" onerror='+onerror_img+' onclick="openImage(this)" src=';
					}
					var notice_str3 = '<p>';
					var notice_str4 = '<p style="font-size: 16px; color: #000000;">'
					if (BASE_APP_TYPE == 1) {
						notice_con = notice_con.replaceAll(notice_str1, notice_str11);
						notice_con = notice_con.replaceAll(notice_str5, notice_str2);
						notice_con = notice_con.replaceAll(notice_str6, notice_str7);
					} else {
						notice_con = notice_con.replaceAll(notice_str1, notice_str2);
						notice_con = notice_con.replaceAll(notice_str6, notice_str7);
					}
					var notice_title = ret.notice.title;
					var notice_person_name = ret.notice.person_name;
					var notice_create_time = ret.notice.create_time;
					var notice_sec_title = '<span class="aui-img-body ellipsis">' + notice_person_name + '</span><span class="create-time">' + notice_create_time + '</span>';
					notice_con = commonTransferBrStr(notice_con);
					notice_con.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi, function (match, capture) {
					  image_array.push(capture);
					});
					$api.html($api.byId('notice_title_div'), notice_title);
					$api.html($api.byId('notice_sec_title'), notice_sec_title);
					$api.html($api.byId('notice_con_div'), notice_con);

					//播放内容需要加密
			        var voice_content = $api.text($api.byId('notice_con_div'));
			        commonVoiceContent(voice_content);
					
				} else {
					popToast('获取新闻资讯内容失败');
				}
			});
		}
		/*
	*author:zhaoj
	*function:打开图片预览
	*date：20171026
	*/
	function openImage(self){
		//图片
		var res_url=$api.attr(self, 'src');
		//打开图片
		var index = 0;
		for(var i = 0; i <image_array.length;i++){
			if(image_array[i] == res_url){
				index = i;
			}
		}
		photoBrowser.open(image_array, index);
	}
	</script>
</html>