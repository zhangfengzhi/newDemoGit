<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- html5：在创建html时为了防止页面缩放等不兼容效果，要创建个viewport  -->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<!-- 在IOS设备上，有时会将数字转为手机号，这里也要禁止下 -->
		<meta name="format-detection" content="telephone=no"/>
		<title>班级通知</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" /><style>
			.history-date {
				font-size: 12px;
			}
			#message-content {
				overflow-y: auto;
				display: none;
			}
			#wrap {
				height: 100%;
				display: -webkit-box;
				display: -webkit-flex;
				display: flex;
				-webkit-box-orient: vertical;
				-webkit-flex-flow: column;
				flex-flow: column;
			}
			.topbar {
				height: 45px;
				/*border-bottom: 1px solid #DDDFE3;*/
				line-height: 45px;
				text-align: center;
				display: none;
				color: #ffffff;
				font-size: 18px;
			}
			.activebar {
				display: block;
			}
			.mTitle {
				width: 50%;
				font-size: 18px;
				text-align: center;
				display: inline-block;
				word-break: keep-all;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}
			.save {
				position: absolute;
				right: 3px;
				top: 0;
				font-size: 16px !important;
				height: 50px;
				line-height: 50px;
			}
			.img_player_style {
				width: 20px;
				height: 20px;
				vertical-align: middle;
			}
		</style>
	</head>
	<body>
		<div id="wrap">
			<header class="aui-bar aui-bar-nav aui-bar-primary" id="aui-header">
				<div id="cloud" class="topbar activebar">
					<div id="back" class="back" onclick="back();" tapmode="">
						<i class="aui-iconfont aui-icon-left"></i>返回
					</div>
					<div class="mTitle" id="mTitle">
						班级通知
					</div>
					<div class="win-menu">
						<a id='menu' style="display: none;" class="aui-iconfont aui-icon-add"  onclick="openTongzhiAddFrame();"></a>
					</div>
				</div>
			</header>
			<div  class="aui-content aui-content-padded" id="message-content">
				<p class="aui-text-center history-date"></p>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../script/plug-in/base64.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js" ></script>
	<script type="text/javascript" src="../../../../../script/assembly/tongjiData.js"></script>
	<script type="text/javascript" src="../../../../../script/assembly/voicePlayer.js" ></script>
	<script type="text/javascript">
		var header_h;//顶部header高度
		var voice_content;//播放内容
		var back_type = 'index';//返回参数
		var voice_type = 2;//朗读页面显示隐藏判断参数，2是打开，1是隐藏
		var voice_content;//朗读内容
		apiready = function() {commonSetTheme({"level":5,"type":0});
			//定位header位置，留出上面电池等空隙，苹果需要
			commonIosAuiHeader();
			header_h = api.pageParam.header_h;
			//打开新闻资讯列表frame
			openTongzhiListFrame();
			//安卓关闭
			commonBackForAndroid();
			commonOpenTjData($api.getStorage("identity")+'_'+api.winName);
		};
		/**
		 * 打开新闻资讯列表frame
		 * 周枫
		 * 2015.11.20
		 */
		function openTongzhiListFrame() {
			reBackType('index');
			//打开新闻资讯frame页面
			var pageParamJson={"header_h":header_h};
			commonOpenFrame('bjtz_index_frame', 'bjtz_index_frame.html',header_h+45, true, true,"#ffffff",pageParamJson);	
		}

		/**
		 * 返回应用页面
		 * 周枫
		 * 2015.10.11
		 */
		function back() {
		$api.css($api.byId('play'), 'display:none;');
			switch(back_type) {
				case 'index':
					commonCloseTjData($api.getStorage("identity")+'_'+api.winName);
					api.closeWin();
					reBackType('index');
					break;
				case 'add':
					commonCloseFrame('bjtz_add_frame');
					reBackType('index');
					break;
				case 'record':
					commonExecScript('bjtz_index_window','','openTongzhiAddFrame() ;',0);
					commonCloseFrame('bjtz_record_frame');
					break;
			}
		}
		/**
		 * 重置从哪个页面退出，是新闻资讯内容页面还是新闻资讯列表页面
		 * 周枫
		 * 2015.10.14
		 */
		function reBackType(type) {
			switch(type) {
				//如果新闻资讯列表页面退出
				case 'index':
					$api.html($api.byId('mTitle'), "班级通知");
					//					$api.css($api.byId('menu'),'display:inline;');
					if ($api.getStorage('is_add_notice') == 1) {
						isAddDisplay(true);
					}
					back_type = 'index';
					commonCloseFrame('common_voiceplay_frame');
					break;
				//如果新闻资讯内容页面退出
				case 'content':
					$api.html($api.byId('mTitle'), "班级通知");
					isAddDisplay(false);
					break;
				//如果新闻资讯内容页面退出
				case 'add':
					$api.html($api.byId('mTitle'), "发布班级通知");
					isAddDisplay(false);
					back_type = 'add';
					break;
			}
		}

		/**
		 * 发布新闻资讯
		 * 周枫
		 * 2015.11.21
		 */
		function openTongzhiAddFrame() {
			reBackType('add');
			//打开新闻资讯内容frame页面
			commonExecScript(api.winName,'bjtz_index_frame','openTongzhiAddFrame();',1)
		}

		/**
		 * 判断发送新闻资讯是否显示
		 * 周枫
		 * 2015.11.25
		 */
		function isAddDisplay(flag) {
			if (flag) {
				$api.css($api.byId('menu'), 'display:inline;');
			} else {
				$api.css($api.byId('menu'), 'display:none;');
			}
		}

	</script>
</html>