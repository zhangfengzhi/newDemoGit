<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- html5：在创建html时为了防止页面缩放等不兼容效果，要创建个viewport  -->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<!-- 在IOS设备上，有时会将数字转为手机号，这里也要禁止下 -->
		<meta name="format-detection" content="telephone=no"/>
		<title>访客教师</title>
		<link rel="stylesheet" type="text/css" href="../../../../../css/aui/aui.css" />
		<link id="j_theme_base" rel="stylesheet" type="text/css" href="" />
		<style>
			.history-date {
				font-size: 12px;
			}
			#message-content {
				overflow-y: auto;
				display: none;
			}
		</style>
	</head>
	<body class="common-iphone-fangke">
		<div id="wrap">
			<header class="aui-bar aui-bar-nav aui-bar-primary" id="aui-header">
				<div id="cloud" class="topbar activebar">
					<div id="back" class="back" onclick="back();" tapmode="">
						<i class="aui-iconfont aui-icon-left"></i>返回
					</div>
					<div class="mTitle" id="mTitle">
						<div id="btn_title" class="btn-title">
							<div class="btn-l btn-top-active btn-top" onclick="changeBtnTitle('add_fangke',0);" id="add_fangke">
								增加访客
							</div>
							<div class="btn-r btn-top" onclick="changeBtnTitle('fangke_jilu',1);" id="fangke_jilu">
								访客记录
							</div>
						</div>
					</div>
					<div class="win-menu">
						<!--<i id='save' class="aui-iconfont aui-icon-roundcheck" onclick="addFkInfoWin();"></i>&nbsp;&nbsp;--> 
						<i id='set'  class="aui-iconfont aui-icon-sitting" onclick="setFkConfig();"></i>
					</div>
				</div>
			</header>
			<div  class="aui-content aui-content-padded" id="message-content">
				<p class="aui-text-center history-date"></p>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="../../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../../script/base_config.js" ></script>
	<script type="text/javascript" src="../../../../../script/common/common.js"></script>
	<script type="text/javascript">
		//顶部header高度
		var header_h;
		apiready = function() {commonSetTheme({"level":5,"type":0});
			header_h = api.pageParam.header_h;
			//打开通知列表frame
			initFrameGroup();
			//定位header位置，留出上面电池等空隙，苹果需要
			commonIosAuiHeader();
			//安卓关闭
			commonBackForAndroid();
		};
		/**
		 * 切换按钮
		 * 周枫
		 * 2016.1.21
		 */
		function changeBtnTitle(btn_id, btn_type) {
			var $btn_title = $api.byId('btn_title');
			var $btn_title_all = $api.domAll($btn_title, 'div');
			var btn_obj=$api.dom('#'+btn_id);
			for (var j = 0; j < $btn_title_all.length; j++) {
				$api.removeCls($btn_title_all[j], 'btn-top-active');
			}
			//定义切换页面样式json
			var rect_json = {};
			if (btn_type == 0) {
				$api.addCls(btn_obj, 'btn-top-active');
				$api.addCls($api.byId('btn_title'), 't_display_b');
				$api.removeCls($api.byId('back'), 't_display_n');
				isAddDisplay(true);
				isSetDisplay(true);
			} else {
				$api.addCls(btn_obj, 'btn-top-active');
				$api.removeCls($api.byId('btn_title'), 't_display_b');
				$api.removeCls($api.byId('back'), 't_display_n');
				isAddDisplay(false);
				isSetDisplay(true);
			}
			api.setFrameGroupIndex({
				name : 'friends_group',
				index : btn_type,
				scroll : true
			});
		}

		function initFrameGroup() {
			api.openFrameGroup({
				name : 'friends_group',
				scrollEnabled : false,
				rect : {
					'x' : 0,
					'y' : header_h,
					'w' : 'auto',
					'h' : api.winHeight - header_h
				},
				index : 0,
				//预加载
				preload : 1,
				scrollToTop : true,
				bounces : true,
				scrollEnabled : false,
				frames : [{
					name : 'fangke_jsadd_frame',
					scrollToTop : true,
					allowEdit : true,
					url : 'fangke_jsadd_frame.html',
					bgColor : '#f7f9f8',
					pageParam : {
						header_h : header_h
					},
					vScrollBarEnabled : true,
					hScrollBarEnabled : false,
					//页面是否弹动 为了下拉刷新使用
					bounces : false
				}, {
					name : 'fangke_jslist_frame',
					scrollToTop : true,
					allowEdit : true,
					url : 'fangke_jslist_frame.html',
					bgColor : '#f7f9f8',
					pageParam : {
						header_h : header_h
					},
					vScrollBarEnabled : true,
					hScrollBarEnabled : false,
					//页面是否弹动 为了下拉刷新使用
					bounces : true
				}]
			}, function(ret, err) {
			});
		}

		/**
		 * 返回应用页面
		 * 周枫
		 * 2016.03.17
		 */
		function back() {
			api.closeFrame({
			    name: 'fangke_index_frame'
			});
			api.closeWin({
			    name: 'fangke_index_window',
			    animation: {
			        type: 'reveal',
			        subType: 'from_left',
			        duration: 300
			    }
			});
			api.closeFrame({
			    name: 'fangke_mwindex_frame'
			});
			api.closeWin({
			    name: 'fangke_mwindex_window',
			    animation: {
			        type: 'reveal',
			        subType: 'from_left',
			        duration: 300
			    }
			});
			api.closeWin();
		}

		/**
		 * 判断增加访客图标是否显示
		 * 周枫
		 * 2016.03.17
		 */
		function isAddDisplay(flag) {
			if (flag) {
				$api.css($api.byId('save'), 'display:inline;');
			} else {
				$api.css($api.byId('save'), 'display:none;');
			}
		}

		/**
		 * 判断配置图标是否显示
		 * 周枫
		 * 2016.03.17
		 */
		function isSetDisplay(flag) {
			if (flag) {
				$api.css($api.byId('set'), 'display:inline;');
			} else {
				$api.css($api.byId('set'), 'display:none;');
			}
		}
		
		function setFkConfig(){
			var pageParamJson = {"header_h":header_h};//打开window页面json数据
			commonOpenWin('fangke_index_window','fangke_index_window.html', false, false, pageParamJson);
		}
	</script>
</html>