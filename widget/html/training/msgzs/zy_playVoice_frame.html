<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- html5：在创建html时为了防止页面缩放等不兼容效果，要创建个viewport  -->
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<!-- 在IOS设备上，有时会将数字转为手机号，这里也要禁止下 -->
		<meta name="format-detection" content="telephone=no"/>
		<title>录音</title>
		<!--<link rel="stylesheet" type="text/css" href="../../../css/aui/aui.css" />-->
		<style>
			  html, body {
            	/*background-color: transparent;*/
       		 }
        	.shadow{position:absolute;left:0;top:0;width:100%;height:100%;z-index: 1;background:#000000;opacity:0.5;}
        	.main{position:absolute;z-index:2;width:60%;height:200px;left:50%;top:50%;margin-left:-30%;margin-top:-100px;z-index: 2;background:#ffffff;box-shadow: 0 2px 5px 3px #666666;}   
	    	.title{ height:63px; border-bottom: 2px solid #74caea; line-height:63px; color:#74caea;padding-left:16px;font-weight:bold;font-size:20px;}	
	    	.button{height:47px;border-top:1px solid #e6e6e6;}
	    	.smt-btn,.cnl-btn{width:50%;height:47px;border:0;background:#ffffff;float: left;}
	    	.smt-btn{border-right:1px solid #e6e6e6 !important;}
	    	.content{height:87px;}
	    	.content div{width:35%;float:left;height:100%;}
	    	.content .num{width:30%;text-align:center;}
	    	.content .reduce img{float:right;}
	    	.content div img{display:inline-block;width:40px;height:40px;margin-top:23px;border-radius:5px;}
	    	.content .num span{display:inline-block;width:36px;height:36px;margin-top:23px;border:2px solid #d8d8d8;border-radius:5px;text-align:center;line-height:36px;}
	    	.bdr-rdu{border-radius:2px;}
	    	.bdr-rdu-top{border-radius:2px 2px 0 0;}
	    	.bdr-rdu-bottom{border-radius:0 0 2px 2px;}
	    	.bdr-rdu-bottom-left{border-radius:0 0 0 2px;}
	    	.bdr-rdu-bottom-right{border-radius:0 0 2px 0;}
	    	.btn-click{background : #50b350;}
	    	.bg{position:relative;height:152px;text-align:center;}
	    	.bg .bgimg{margin-top:15px;}
	    	.bgtext{height:30px;position:absolute;bottom:2px;left:0;width:100%;}
	    	.bgtext p{margin-top:3px;}
		</style>
	</head>
	<body>
		<div class="shadow"></div>
		<div class="main bdr-rdu">
			<div class="bg" id="bg">
				<img src="../../../image/yingyong/laba.png" width="100" height="100" class="bgimg" id="bgimg"/>
				<div class="bgtext">
					<p id="bgtext">正在缓冲</p>
				</div>
			</div>
			<div class="button bdr-rdu-bottom">
				<button id='j_pause_btn' class="smt-btn bdr-rdu-bottom-left" tapmode="btn-click" onclick="pausePlay();">暂停</button>
				<button id='j_continue_btn' class="smt-btn bdr-rdu-bottom-left" tapmode="btn-click" style="display:none;" onclick="playVoice(2);">继续</button>
				<button class="cnl-btn bdr-rdu-bottom-right" tapmode="btn-click" onclick="stopVoice();">停止</button>
			<div>
		</div>
		<script type="text/javascript" src="../../../script/api.js" ></script>
		<script type="text/javascript" src="../../../script/base_config.js" ></script>
	</body>
	
	<script type="text/javascript">
		var netAudio;//播放录音对象
		var isPlay = false;//是否正在播放录音
		apiready = function() {
			netAudio = api.require('netAudio');
			playVoice(1);
		};
		/*
		*author:zhaoj
		*function:暂停录音
		*date：20160225
		*/
		function pausePlay(){
			if(isPlay){
				netAudio.pause();
				document.getElementById('bgimg').src = '../../../image/yingyong/laba.png';
				document.getElementById('bgtext').innerHTML = '暂停播放';
				document.getElementById('j_continue_btn').innerHTML = '继续';					
				$api.css($api.byId('j_pause_btn'),'display:none');
				$api.css($api.byId('j_continue_btn'),'display:inline-block');				
			}
		}
		/*
		*author:zhaoj
		*function:播放录音
		*date：20160225
		*/
		function playVoice(type){
			if(type==1){
				document.getElementById('bgimg').src = '../../../image/yingyong/laba.png';
				document.getElementById('bgtext').innerHTML = '正在缓冲';
			}else{
				document.getElementById('bgimg').src = '../../../image/yingyong/play.gif';
				document.getElementById('bgtext').innerHTML = '正在播放';
			}
			
			$api.css($api.byId('j_continue_btn'),'display:none');
			$api.css($api.byId('j_pause_btn'),'display:inline-block');
			netAudio.play({
			    path: api.pageParam.voicePath
			},function( ret, err ){    
			    if( ret ){
			    	if(ret.current == 0){
			    		isPlay = true;
			    		document.getElementById('bgimg').src = '../../../image/yingyong/play.gif';
			            document.getElementById('bgtext').innerHTML = '正在播放';
			    	}
			    	if(ret.complete==true){
			    		isPlay = false;
			    		document.getElementById('bgimg').src = '../../../image/yingyong/laba.png';
			    		document.getElementById('bgtext').innerHTML = '播放完毕';
			    		document.getElementById('j_continue_btn').innerHTML = '重播';	
			    		$api.css($api.byId('j_pause_btn'),'display:none');
						$api.css($api.byId('j_continue_btn'),'display:inline-block');	
			    	}
			    }else{
			    	document.getElementById('bgtext').innerHTML = '播放失败';
			    }
			});
		}
		/*
		*author:zhaoj
		*function:停止录音
		*date：20160225
		*/
		function stopVoice(){
			netAudio.stop();
			closeFrame();
		}
		/*
		*author:zhaoj
		*function:关闭当前frame
		*date：20160222
		*/
		function closeFrame(){
			api.execScript({
				name : 'zy_index_window',
				script : 'reBackType("content","","");'
			});
			api.closeFrame({name:'zy_playVoice_frame'});
		}
	</script>
</html>