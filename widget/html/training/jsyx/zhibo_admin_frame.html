<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>主播用户直播frame</title>
		<link rel="stylesheet" type="text/css" href="../../../css/training/jsyx/aui.css" />
		<style>
			body {
			}
		</style>
	</head>
	<body></body>
	<script type="text/javascript" src="../../../script/api.js"></script>
	<script type="text/javascript" src="../../../script/training/jsyx/zbLive.js" ></script>
	<script type="text/javascript">
		//顶部header高度
		var header_h;
		var room_id;
		var anchor_pwd;
		var assist_pwd;
		var user_pwd;
		var room_name;
		var person_name = $api.getStorage('person_name');
		
		apiready = function() {
			header_h = api.pageParam.header_h;
			room_id = api.pageParam.room_id;
			anchor_pwd = api.pageParam.anchor_pwd;
			assist_pwd = api.pageParam.assist_pwd;
			user_pwd = api.pageParam.user_pwd;
			room_name = api.pageParam.room_name;
			openViewPlay();
		};
		function openViewPlay() {
			//			zbLivePublisher.stop();
			zbLiveCore.destroyRoomSession(room_id, anchor_pwd, person_name);
			zbLiveCore.authRoomSession(room_id, anchor_pwd, person_name, function(is_true, data) {
				if (is_true) {
					zbLivePublisher.init(room_id, anchor_pwd, person_name);
					zbLivePublisher.setVideoPreset(api.frameWidth, api.frameHeight);
					zbLivePublisher.startPreview('zhibo_admin_frame', 'front', 0, 0, api.frameWidth, api.frameHeight);
				}
			});
		}
		
		/**
		 * 开始 / 关闭直播
		 * 周枫
		 * 2016.11.03 
		 */
		function isPublisher(type) {
			if(type == 1) {
				zbLivePublisher.login(function(is_true, data) {
					api.toast({
		                msg:'开始直播'
	                });
					zbLivePublisher.publish();
				});
			} else {
				api.toast({
	                msg:'关闭直播'
                });
				zbLivePublisher.unpublish();
			}
		}
		
		/**
		 * 打开/关闭麦克风
		 * 周枫
		 * 2016.11.03 
		 */
		function isSetMute(type) {
			if(type == 1) {
				api.toast({
	                msg:'打开麦克风'
                });
				zbLivePublisher.setMute(true);
			} else {
				api.toast({
	                msg:'关闭麦克风'
                });
				zbLivePublisher.setMute(false);
			}
			
		}
		
		/**
		 * 打开/关闭滤镜
		 * 周枫
		 * 2016.11.03 
		 */
		function isFilter(type) {
			var is_filter = 'normal';
			if(type == 0) {
				is_filter = 'smoothSkin';
				api.toast({
	                msg:'打开滤镜'
                });
			} else {
				is_filter = 'normal';
				api.toast({
	                msg:'关闭滤镜'
                });
			}
			zbLivePublisher.setFilter(is_filter);
		}
		
		/**
		 * 切换摄像头
		 * 周枫
		 * 2016.11.03 
		 */
		function isCamera(){
			zbLivePublisher.switchCamera();
		}
	</script>
</html>